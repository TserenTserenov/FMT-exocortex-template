# ADR-001: setup.sh встроен в шаблон

**Статус:** Принято
**Дата:** 2026-02-28
**Контекст:** FMT-exocortex-template, DS-ai-systems/setup

---

## Контекст

До v0.3.0 скрипт `setup.sh` находился в отдельном репозитории `DS-ai-systems/setup/`. Пользователь должен был:
1. Клонировать `DS-ai-systems`
2. Перейти в `DS-ai-systems/setup/`
3. Запустить `bash setup.sh`

Обоснование: онтологическое разделение типов (FMT = Format, DS = instrument) и контуров (L2 Platform → L3 Template → L4 Personal).

## Проблема

Пользователи не могут форкнуть шаблон и запустить его — `setup.sh` отсутствует в форке. Нужно клонировать дополнительный репо, к которому может не быть доступа.

**АрхГейт (ЭМОГССБ):**

| Характеристика | Было (external) | Стало (embedded) |
|----------------|----------------|-----------------|
| Эволюционируемость | 7 | 8 |
| Масштабируемость | 8 | 8 |
| Обучаемость | 5 | 9 |
| Генеративность | 3 | 9 |
| Скорость | 7 | 8 |
| Современность | 7 | 8 |
| Безопасность | 8 | 8 |
| **Среднее** | **6.4** | **8.3** |

Текущее решение ниже порога 8. Генеративность (3) и Обучаемость (5) — критически низкие.

## Решение

Перенести `setup.sh` в корень FMT-exocortex-template (рядом с `update.sh`).

**Что перенесено:**
- `setup.sh` — модифицирован: авто-определение TEMPLATE_DIR, убран шаг форка (пользователь форкает сам)
- `setup/validate-template.sh` — валидация шаблона

**Что осталось в DS-ai-systems:**
- `template-sync.sh` + `sync-manifest.yaml` — авторские инструменты (не нужны пользователю)
- `.sync-hashes/` — runtime-состояние авторского sync

**Новый пользовательский flow:**
```bash
gh repo fork TserenTserenov/FMT-exocortex-template --clone --remote
cd FMT-exocortex-template
bash setup.sh
```

## Принципы

- **Автономность модулей** — шаблон теперь самодостаточен
- **Генеративность** — fork = работающая система (cookiecutter-паттерн)
- **Разделение ответственности** — авторские инструменты sync остаются в DS-ai-systems

## Последствия

- template-sync.sh должен синхронизировать setup.sh как ещё один файл
- DS-ai-systems/setup/setup.sh оставить с deprecation notice (обратная совместимость)
- sync-manifest.yaml: добавить entry для setup.sh
